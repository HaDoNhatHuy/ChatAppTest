@{
    ViewData["Title"] = "Chat";
}
@section Scripts
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.7/signalr.min.js"></script>
    <script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>
    <script>
        // Truyền username từ ViewBag sang JavaScript
        const currentUser = "@ViewBag.Username";
    </script>
    <script src="~/js/chat.js"></script>
}
<div class="chat-container">
    <!-- Sidebar Left: Chat Rooms -->
    <div class="sidebar">
        <h5 class="text-center mb-3">Chat Rooms</h5>
        <div class="mb-3">
            <label for="roomName" class="form-label">Enter room name</label>
            <input type="text" id="roomName" class="form-control" placeholder="Room name" />
        </div>
        <button id="joinRoomButton" class="btn btn-primary w-100 mb-3">Join Room</button>
        <h6 id="groupError" class="text-danger text-center"></h6>
    </div>

    <!-- Chat Area -->
    <div class="chat-area">
        <div class="p-3 border-bottom">
            <h5 class="text-center" id="chat-intro">Select a room to start chatting</h5>
        </div>
        <div class="messages">
            <ul id="messagesList" class="list-unstyled"></ul>
        </div>
        <div class="input-area d-flex">
            <textarea id="messageInput" class="form-control me-2" placeholder="Type a message..." rows="2"></textarea>
            <button id="sendButton" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Send</button>
            <button id="startVideoCall" class="btn btn-success ms-2"><i class="fas fa-video"></i> Call</button>
        </div>
        <div id="videoContainer" class="d-none p-3 bg-light">
            <video id="localVideo" autoplay muted class="w-50 d-inline-block"></video>
            <video id="remoteVideo" autoplay class="w-50 d-inline-block"></video>
        </div>
    </div>

    <!-- Sidebar Right: Users Online -->
    <div class="sidebar">
        <h5 class="text-center mb-3">Users Online</h5>
        <ul id="userOnlineList" class="list-unstyled"></ul>
    </div>
</div>