@{
    ViewData["Title"] = "Chat";
}
@section Scripts
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.7/signalr.min.js"></script>
    <script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>
    <script>
        // Truyền username từ ViewBag sang JavaScript
        const currentUser = "@ViewBag.Username";
    </script>
    <script src="~/js/chat.js"></script>
}
<div class="chat-container">
    <!-- Sidebar Left: Chat Rooms -->
    <div class="sidebar left-sidebar">
        <div class="p-3 border-bottom">
            <h5 class="text-center mb-0">Chat Rooms</h5>
        </div>
        <div class="p-3">
            <div class="input-group mb-3">
                <input type="text" id="roomName" class="form-control rounded-pill" placeholder="Enter room name" />
                <button id="joinRoomButton" class="btn btn-primary ms-2 rounded-pill">Join</button>
            </div>
            <h6 id="groupError" class="text-danger text-center"></h6>
            <ul id="roomList" class="list-unstyled mt-3">
                <!-- Rooms will be dynamically added here -->
            </ul>
        </div>
    </div>

    <!-- Chat Area -->
    <div class="chat-area">
        <div class="chat-header p-3 border-bottom d-flex align-items-center">
            <h5 class="mb-0 flex-grow-1" id="chat-intro">Select a room to start chatting</h5>
            <button id="endCallButton" class="btn btn-danger d-none rounded-pill">End Call</button>
        </div>
        <div class="messages p-3">
            <ul id="messagesList" class="list-unstyled"></ul>
        </div>
        <div class="input-area p-3 border-top d-flex align-items-center">
            <textarea id="messageInput" class="form-control rounded-pill me-2" placeholder="Type a message..." rows="1"></textarea>
            <button id="sendButton" class="btn btn-primary rounded-circle"><i class="fas fa-paper-plane"></i></button>
            <button id="startVideoCall" class="btn btn-success rounded-circle ms-2"><i class="fas fa-video"></i></button>
        </div>
        <div id="videoContainer" class="video-container d-none p-3 bg-dark">
            <div class="video-wrapper">
                <video id="localVideo" autoplay muted class="local-video"></video>
                <video id="remoteVideo" autoplay class="remote-video"></video>
            </div>
        </div>
    </div>

    <!-- Sidebar Right: Users Online -->
    <div class="sidebar right-sidebar">
        <div class="p-3 border-bottom">
            <h5 class="text-center mb-0">Users Online</h5>
        </div>
        <ul id="userOnlineList" class="list-unstyled p-3"></ul>
    </div>
</div>